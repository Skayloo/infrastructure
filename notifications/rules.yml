---
groups:
  - name: Sausage store rules
    rules:
    - alert: InstanceDown
      expr: up{app="backend"} == 0
      for: 1m
      labels:
        severity: critical
        project: "sausage_store"
        component: "backend"
    - alert: InternalError
      expr: |
        http_server_requests_seconds_count{status=~"5.."}
      for: 1m
      labels:
        severity: critical
        project: "sausage_store"
        component: "backend"
    - alert: OrdersErrorQuantile
      expr: |
        histogram_quantile(0.95,
          http_server_requests_seconds_bucket{status=~"2..",uri="/api/orders"}
        ) >= 0.100000000000
      for: 5m
      labels:
        severity: critical
        project: "sausage_store"
        component: "backend"
    - alert: PrometheusActuator
      expr: |
        http_server_requests_seconds_count{uri="/actuator/prometheus", status=~"5.."}
      for: 2m
      labels:
        severity: critical
        project: "sausage_store"
        component: "backend"